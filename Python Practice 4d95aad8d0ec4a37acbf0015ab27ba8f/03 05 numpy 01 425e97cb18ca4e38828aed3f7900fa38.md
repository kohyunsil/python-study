# 03/05 numpy 01

NUMPY 01

- pythonì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³¼í•™ê³„ì‚°ìš© íŒ¨í‚¤ì§€
- Pythonì˜ ëŠë¦° ì—°ì‚°ì†ë„ë¥¼ ë³´ì™„
- ndarry ë°ì´í„° íƒ€ì…ì˜ ë°°ì—´ ê°ì²´ë¡œ ì—°ì‚°
- C, C++, í¬íŠ¸ë€ìœ¼ë¡œ ë§Œë“¤ì–´ì§

ğŸ¥‘ **ndarray ê°ì²´ ìƒì„±**

- listì™€ ndarrayì˜ ë‹¤ë¥¸ì 
    - listëŠ” ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° íƒ€ì…ì„ ì‚¬ìš©
    - ndarrayëŠ” ê°™ì€ ë°ì´í„° íƒ€ì…ë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥
    - ì—°ì‚°í•˜ëŠ” ë°©ë²•ì´ ë‹¤ë¥´ë‹¤

```python
import numpy as np

ls = [1, 2, 3]
arr = np.array(ls)

type(ls), type(arr)

ls + ls, arr + arr

# ì„ í˜•ëŒ€ìˆ˜ 
# ìŠ¤ì¹¼ë¼(5), ë²¡í„°([1,2,3]), ë§¤íŠ¸ë¦­ìŠ¤([[1,2,3],[4,5,6]])

arr2 = np.array([[1,2,3],[4,5,6]])
arr2

# ë°°ì—´ì˜ ì°¨ì› í™•ì¸ ì‹œ ì‚¬ìš© (ndim)
arr.ndim, arr2.ndim

# ë°°ì—´ì˜ ëª¨ì–‘ì„ í™•ì¸ (shape)
arr.shape, arr2.shape

arr3 = np.array(list("ABCD"))
arr3

# ë°°ì—´ì˜ ë°ì´í„° íƒ€ì… í™•ì¸ (dtype)
arr.dtype, arr3.dtype

# ë°ì´í„° íƒ€ì…ì˜ ë³€ê²½ (astype)
arr4 = arr.astype("float")
# ì´ê²ƒë„ ê°€ëŠ¥ >> arr4 = arr.astype(np.float32)
arr4.dtype

# np.arange()
# arange : rangeì™€ ê°™ì€ ê·œì¹™ì„ ê°–ìŠµë‹ˆë‹¤. ê²°ê³¼ ë°ì´í„°ê°€ ndarray ë°ì´í„° íƒ€ì…ì…ë‹ˆë‹¤.
np.arange(5)
np.arange(5,8)
np.arange(1,8,2) # ë‘ì¹¸ì”© ëœ€

# np.zeros(), np.ones()
# np.zeros(): 0ìœ¼ë¡œ ì±„ì›Œì§„ í–‰ë ¬ ë°ì´í„°ë¥¼ ìƒì„±
# np.ones() : 1ë¡œ ì±„ì›Œì§„ í–‰ë ¬ ë°ì´í„°ë¥¼ ìƒì„±

zero_data = np.zeros((4, 2, 3))
zero_data

one_data = np.ones((4, 2, 3))
one_data
```

randomìœ¼ë¡œ í–‰ë ¬ ë°ì´í„° ìƒì„±

## ğŸ¥‘ np.random

- rand() : ê· ë“±ë¶„í¬ë¡œ ë‚œìˆ˜ ë°œìƒ
- randn() : ì •ê·œë¶„í¬ë¡œ ë‚œìˆ˜ ë°œìƒ
- randint() : ì •ìˆ˜ë¡œ ë‚œìˆ˜ ë°œìƒ(ê· ë“±ë¶„í¬)

```python
# ê· ë“±ë¶„í¬ : uniform 
data = np.random.rand(10)    # ë‚œìˆ˜ ë°œìƒ :  0~1 ì‚¬ì´ì˜ float ë°ì´í„° ìƒì„±
data

# ì •ê·œë¶„í¬ : gaussian : 0ì„ ê¸°ì¤€ìœ¼ë¡œ float ë°ì´í„°ê°€ ìƒì„±
data = np.random.randn(10)
data

# randint : ì •ìˆ˜ ë°ì´í„° íƒ€ì…ì„ ê· ë“±ë¶„í¬ë¡œ ìƒì„±
np.random.randint(5, size =(2, 3))

np.random.randint(-3, 5, (2, 3))

# seed()
# numpyì˜ ëœë¤ê°’ì€ seed ê°’ìœ¼ë¡œ ìƒì„± í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ seed ê°’ì´ ê°™ìœ¼ë©´ ë™ì¼í•œ ëœë¤ê°’ì´ ì¶œë ¥ë©ë‹ˆë‹¤.

np.random.seed(1)
data1 = np.random.randint(0, 100, 10)

np.random.seed(1)
data2 = np.random.randint(0, 100, 10)

np.random.seed(2)
data3 = np.random.randint(0, 100, 10)

data1, data2, data3

# choice()
# íŠ¹ì • ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ ëœë¤í•˜ê²Œ ì„ íƒí•˜ëŠ”ë° í™•ë¥  ì„¤ì •ì´ ê°€ëŠ¥

np.random.choice(5, 10, p=[0.1, 0.0, 0.5, 0.2, 0.2]) # 5ëŠ” ë²”ìœ„ 10ì€ size, 
                                                     # p = í™•ë¥ ì§€ì • (í•©ì³¤ì„ë•Œ 1ì´ ë˜ì–´ì•¼í•¨. 1ì´ë‚˜ì˜¬í™•ë¥  10ì´ê³  2ë‚˜ì˜¬í™•ë¥  0ì´ê³ ,,)
```

 ndarray ê°ì²´ì—ì„œ ë°ì´í„° ì„ íƒ

```python
data = np.random.randint(5, size=(3,3))
data

data[1] # 1ë²ˆì§¸ í–‰ ì¶œë ¥

data[1][2] # 1ë²ˆì§¸ í–‰ì˜ 2ë²ˆì§¸ ë°ì´í„°

data[1, 2] # 1ë²ˆì§¸ í–‰ì˜ 2ë²ˆì§¸ ë°ì´í„°

data2 = np.random.randint(10, size=10)
data2

data2[:3]

data2[-1], data2[-3:], data2[::-2]

data[1:][1:]

data[1:, 1:]

```

 ndarrayì—ì„œ ë°ì´í„° ìˆ˜ì •

```python
# vector = vector
data2[3:6] = [11, 12, 13]    # [3:6] ê³¼ [11,12,13] ì²˜ëŸ¼ ê°¯ìˆ˜ë¥¼ ë§ì¶°ì¤˜ì•¼ ì—ëŸ¬ì•ˆë‚¨
data2

# vector = scala > broadcasting ì˜ íŠ¹ì§•
data2[3:6] = 20
data2

# matrix = matrix
data[1:, 1:] = [[11, 12], [13, 14]]
data

# matrix = vector
data[1:, 1:] = [21, 22]
data

# matrix = scala
data[1:, 1:] = 30
data
```

- ë°°ì—´ì˜ ì°¨ì› ë³€ê²½ reshape()

```python
data = np.random.randint(10, size=(3, 4)) #size ê³±í–ˆì„ë•Œ ê°™ì•„ì•¼í•¨ 12
data

data.reshape(2, 6) # 2*6 =12
data.reshape(2, 2, 3) # 2*2*3 = 12

data.reshape(4, -1)

np.zeros_like(data), np.ones_like(data)
```

 ndarrayì˜ ì—°ì‚°

```python
data1 = np.array([1,2,3])
data2 = np.array([1,2,3,4])
data3 = np.random.randint(5, size=(4, 3))

data1, data2, data3
data3 + data1

data3 + data2.reshape(4, 1)  # data2ì˜ í–‰ë ¬ë°”ê¿”ì¤€í›„ ê°™ì€ ìœ„ì¹˜ë¡œ ë§Œë“¤ì–´ ì—°ì‚°

# ë¹„êµì—°ì‚° : masking : [] > í•„í„°ë§ ê¸°ëŠ¥
data3 >= 2
data3[data3 >= 2]
data3[data3 >= 2]=10
data3

# np.where(condition, True, False)

data = np.random.randint(10, size=(2, 3))
data

np.where(data < 5, 0, 10)
```

 ë…¼ë¦¬ì—°ì‚° (all = and, any = or)

- all : í–‰ë ¬ ë°ì´í„°ë¥¼ ë¹„êµ ì—°ì‚°í•œ ê²°ê³¼ê°€ í•˜ë‚˜ë¼ë„ Falseì´ë©´ False
- any : í–‰ë ¬ ë°ì´í„°ë¥¼ ë¹„êµ ì—°ì‚°í•œ ê²°ê³¼ê°€ í•˜ë‚˜ë¼ë„ True ì´ë©´ True

```python
data1 = np.array([1, 2, 3])
data2 = np.array([1, 2, 3])
data3 = np.array([1, 0, 3])

data1, data2, data3

data1 == data2, data1 == data3

np.all(data1 == data2), np.all(data1 == data3)

np.any(data1 == data2), np.any(data1 == data3)
```

```python
data = np.random.randint(10, size=(3, 4))
data

# 8ì´ìƒì¸ ë°ì´í„°ê°€ ìˆëŠ” rowë§Œ ì¶œë ¥

data >= 8
row = np.any(data >= 8, axis=1)  #axis = ì¶• ì¸ë° 1ë¡œ ë„£ì–´ì£¼ë©´ í–‰ë§ˆë‹¤ ì—°ì‚° 0ì´ë©´ ì„¸ë¡œì¶•

data[row]

#ì„¸ë¡œì¶•ì¼ë•Œ
column = np.any (data >= 8, axis=0)
column

data[:, column]
```